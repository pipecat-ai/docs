---
title: "Context Summarization"
description: "Reference for LLMContextSummarizationConfig, LLMContextSummarizer, and SummaryAppliedEvent"
---

## Overview

Context summarization automatically compresses older conversation history when token or message limits are reached. It is configured via `LLMContextSummarizationConfig` and managed by `LLMContextSummarizer`.

For a walkthrough of how to enable and customize context summarization, see the [Context Summarization guide](/guides/fundamentals/context-summarization).

## LLMContextSummarizationConfig

```python
from pipecat.utils.context.llm_context_summarization import LLMContextSummarizationConfig
```

Controls when and how context summarization occurs.

<ParamField path="max_context_tokens" type="int" default="8000">
  Maximum context size in estimated tokens before triggering summarization.
  Tokens are estimated using the heuristic of 1 token per 4 characters.
</ParamField>

<ParamField path="target_context_tokens" type="int" default="6000">
  Target token count for the generated summary. Passed to the LLM as
  `max_tokens`. Auto-adjusted to 80% of `max_context_tokens` if it exceeds that
  value.
</ParamField>

<ParamField path="max_unsummarized_messages" type="int" default="20">
  Maximum number of new messages before triggering summarization, even if the
  token limit has not been reached.
</ParamField>

<ParamField path="min_messages_after_summary" type="int" default="4">
  Number of recent messages to preserve uncompressed after each summarization.
</ParamField>

<ParamField path="summarization_prompt" type="Optional[str]" default="None">
  Custom system prompt for the LLM when generating summaries. When `None`, uses
  a built-in default prompt.
</ParamField>

<ParamField
  path="summary_message_template"
  type="str"
  default='"Conversation summary: {summary}"'
>
  Template for formatting the summary when injected into context. Must contain `
  {summary}` as a placeholder. Allows wrapping summaries in custom delimiters
  (e.g., XML tags) so system prompts can distinguish summaries from live
  conversation.
</ParamField>

<ParamField path="llm" type="Optional[LLMService]" default="None">
  Dedicated LLM service for generating summaries. When set, summarization
  requests are sent to this service instead of the pipeline's primary LLM.
  Useful for routing summarization to a cheaper or faster model. When `None`,
  the pipeline LLM handles summarization.
</ParamField>

<ParamField path="summarization_timeout" type="Optional[float]" default="120.0">
  Maximum time in seconds to wait for the LLM to generate a summary. If
  exceeded, summarization is aborted and future summarization attempts are
  unblocked. Set to `None` to disable the timeout.
</ParamField>

## LLMContextSummarizer

```python
from pipecat.processors.aggregators.llm_context_summarizer import LLMContextSummarizer
```

Monitors context size and orchestrates summarization. Created automatically by `LLMAssistantAggregator` when `enable_context_summarization=True`. Access it via `assistant_aggregator._summarizer`.

### Event Handlers

| Event                | Parameters                   | Description                                                           |
| -------------------- | ---------------------------- | --------------------------------------------------------------------- |
| `on_summary_applied` | `event: SummaryAppliedEvent` | Emitted after a summary has been successfully applied to the context. |

#### on_summary_applied

```python
@summarizer.event_handler("on_summary_applied")
async def on_summary_applied(summarizer, event: SummaryAppliedEvent):
    logger.info(
        f"Context summarized: {event.original_message_count} -> "
        f"{event.new_message_count} messages"
    )
```

## SummaryAppliedEvent

```python
from pipecat.processors.aggregators.llm_context_summarizer import SummaryAppliedEvent
```

Event data emitted when context summarization completes successfully.

<ParamField path="original_message_count" type="int">
  Number of messages in context before summarization.
</ParamField>

<ParamField path="new_message_count" type="int">
  Number of messages in context after summarization.
</ParamField>

<ParamField path="summarized_message_count" type="int">
  Number of messages that were compressed into the summary.
</ParamField>

<ParamField path="preserved_message_count" type="int">
  Number of messages preserved uncompressed (system message plus recent
  messages).
</ParamField>
